using System;
using System.IO;

namespace BedrockTools_Build.Generator {
    public class SourceGenerator  {
        public string Target { get; set; }
        public ICodeGenerator CodeGenerator { get; set; }
        

        public SourceGenerator(string target, ICodeGenerator codeGenerator) {
            Target = target;
            CodeGenerator = codeGenerator;
        }

        public virtual void WriteCode() {
            Console.WriteLine("Writing file: "+Target);
            CodeBuilder builder = new CodeBuilder();
            builder
                .WriteLine("//==============================================================================")
                .WriteLine("// THIS CODE WAS AUTOGENERATED BY @BedrockTools_Build")
                .WriteLine("// Do not modify, any changes will be lost when the generation tool is run again")
                .WriteLine($"// Last build: {DateTime.UtcNow.ToString("yyyy - MM - dd HH: mm:ss")} UTC")
                .WriteLine("//==============================================================================");
            builder.Write(CodeGenerator.GetCode());
            File.WriteAllText(Path.Combine(Setting.ProjectPath, Target), builder.ToString());
        }        
    
    }
}
